let clients = [{
        firstName: "Estefânio",
        lastName: "de Souza",
        id: 1290763872,
        description: "Reach the full potential of your Customer Experience blueprint with Kinetic CX as your implementation",
        rate: "70.00",
        balance: "000.00",
        deposit: "560.00",
        status: "active",
        currency: "INR",
        selected: "selected"
    },
    {
        firstName: "Alexis",
        lastName: "White",
        id: 1188763567,
        description: " employee development, or journey mapping, our professionals have the tools and",
        rate: "50.00",
        balance: "700.00",
        deposit: "960.00",
        status: "inactive",
        currency: "INR"
    },
    {
        firstName: "Wyatt",
        lastName: "loof Cox",
        id: 7867875643,
        description: "We provide more than just expert customer experience professionals for your project.",
        rate: "70.00",
        balance: "700.00",
        deposit: "960.00",
        status: "inactive",
        currency: "INR"
    },
    {
        firstName: "Leo",
        lastName: "Jarvi",
        id: 7376543210,
        description: "Being able to deliver consistently high levels of services across all touchpoints at every",
        rate: "60.00",
        balance: "400.00",
        deposit: "360.00",
        status: "active",
        currency: "INR"
    },
    {
        firstName: "Anaëlle",
        lastName: "Olivier",
        id: 6789056789,
        description: "Organizations are continuously seeking to deliver new value for their customers to build trust and loyalty.",
        rate: "60.00",
        balance: "-350.00",
        deposit: "160.00",
        status: "active",
        currency: "INR"
    },
    {
        firstName: "Matilda",
        lastName: "Wang",
        id: 0989098767,
        description: " Let our professionals in process excellence and training instil new work practices that can",
        rate: "70.00",
        balance: "550.00",
        deposit: "500.00",
        status: "inactive",
        currency: "INR"
    },
    {
        firstName: "Pilar",
        lastName: "de Ramirez",
        id: 3345432345,
        description: "initiative, our objective is to empower your employees to deliver your CX vision continually.",
        rate: "20.00",
        balance: "900.00",
        deposit: " 100.00",
        status: "active",
        currency: "INR"
    }, {
        firstName: "James",
        lastName: "Herrera",
        id: 1123450003,
        description: "gem materials (including amber, jet, coral, ivory, pearls, tortoise-shell, and synthetic stones",
        rate: "40.00",
        balance: "-550.00",
        deposit: "709.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Storm",
        lastName: "Moller",
        id: 3345432245,
        description: "Volume 2 presents a history of gem testing, describes the use and working of a number of",
        rate: "50.00",
        balance: "450.00",
        deposit: "200.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Monica",
        lastName: "Cruz",
        id: 1000454323,
        description: "The title should describe what the article shows the reader. Do not begin the title with the word",
        rate: "50.00",
        balance: "-550.00",
        deposit: "879.00",
        status: "active",
        currency: "INR"
    }, {
        firstName: "Ryder",
        lastName: "Li",
        id: 3555432345,
        description: "alphabetize articles. Try “Joining a Conversation” rather than “How to Join a Conversation",
        rate: "30.00",
        balance: "-300.00",
        deposit: " 200.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Emir",
        lastName: "Hoff",
        id: 1100445323,
        description: "The slug is the link to the article. Keep it short. The slug for “Joining a Conversation",
        rate: "20.00",
        balance: "-550.00",
        deposit: "700.00",
        status: "active",
        currency: "INR"
    }, {
        firstName: "Emily",
        lastName: "King",
        id: 1123455443,
        description: "Most articles are related to other articles. Type in the beginning of the name of a related article.",
        rate: "40.00",
        balance: "-200.00",
        deposit: "800.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Maximilian",
        lastName: "Lucas",
        id: 7778432345,
        description: " Keywords can improve search results by adding terms that are not included in the article's Search result summary.",
        rate: "50.00",
        balance: "500.00",
        deposit: " 400.00",
        status: "active",
        currency: "INR"
    }, {
        firstName: "Vildan",
        lastName: "Tüzün",
        id: 1123888873,
        description: " Doing so will lower the amount of points awarded to your keyword, resulting in your article's search ranking diminishing. ",
        rate: "30.00",
        balance: "-250.00",
        deposit: "780.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Klaus",
        lastName: "Roy",
        id: 1100004323,
        description: "In search result summary, type in a sentence or two that explains what the article is about. Try to include keywords in those sentences.",
        rate: "40.00",
        balance: "450.00",
        deposit: "760.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Florência",
        lastName: "Souza",
        id: 1123000000,
        description: "refrain from adding related documents in new articles that will be pending review. ",
        rate: "45.00",
        balance: "750.00",
        deposit: "650.00",
        status: "active",
        currency: "INR"
    }, {
        firstName: "Lorraine",
        lastName: "Chambers",
        id: 1123066700,
        description: " there are drop down menus. If your article is relevant to Firefox ",
        rate: "55.00",
        balance: "-550.00",
        deposit: "950.00",
        status: "active",
        currency: "INR"
    }, {
        firstName: "Brandon",
        lastName: "Byrd",
        id: 1123067230,
        description: "We often acquire knowledge about the world through the detailed process of Description.",
        rate: "60.00",
        balance: "250.00",
        deposit: "350.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Alvin",
        lastName: "Ferguson",
        id: 8989067230,
        description: "Representing the work of students from hundreds of institutions around the globe",
        rate: "30.00",
        balance: "-550.00",
        deposit: "550.00",
        status: "inactive",
        currency: "INR"
    }, {
        firstName: "Asuncion",
        lastName: "Moreno",
        id: 8987878730,
        description: "Depending on the expedited review option you choose, you can receive a decision in as few as 5-days.",
        rate: "10.00",
        balance: "-650.00",
        deposit: "750.00",
        status: "active",
        currency: "INR"
    }
];

const tableElement = document.getElementById("table");
const searchElement = document.getElementById("search");
const statusElement = document.getElementById("status");
const nameElement = document.getElementById("name");
const activeCustomerElement = document.getElementById("active-clients");
const selectElement = document.getElementById("select");
const displayedCustomerElement = document.getElementById("displayed-customer");
const previousPageElement = document.getElementById("prevouis-page");
const nextPageElement = document.getElementById("next-page");
const firstNameElement = document.getElementById("first-name");
const lastNameElement = document.getElementById("last-name");
const descriptionElement = document.getElementById("description");
const balanceElement = document.getElementById("balance");
const rateElement = document.getElementById("rate");
const currencyElement = document.getElementById("currency");
const customerStatusElement = document.getElementById("customer-status");
const form = document.getElementById("form");
const numberElement = document.getElementById("number");
const depositElement = document.getElementById("deposit");
const addCustomer = document.getElementById("add");
const notificationElement = document.getElementById("notification");
const percentElement = document.getElementById("percent");
const progressElement = document.getElementById("progress");
const validationForm = document.getElementById("validation-form");
const submitBtn = document.getElementById("submit");
const updateBtn = document.getElementById("update");
const formHeaderElement = document.getElementById("form-header");
const btnGroupElement = document.getElementById("btn-group");
const cancelBtn = document.getElementById("cancel");
const filterElement = document.getElementById("filter");
const sortModuleElement = document.getElementById("sort-module");
const radioInputsElements = document.querySelectorAll("input[type='radio']");
let sortStatusOrder, sortNameOrder;
let currentPage = 1;
let rowsPerPage;
let customersReadyToRender;
let tableRowElement;
let customerToUpdate;
let customerToUpdateIndex;
let originalCustomersListCopy;
let sortBy;
let inputsElements = [currencyElement, customerStatusElement, descriptionElement, depositElement, firstNameElement, rateElement, lastNameElement, balanceElement, numberElement];

function countValidInputs(inputs) {
    return inputs.filter(input => {
        return input.classList.contains("success");
    }).length;
}

function setCustomersInLocalStorageOnce(originalCustomesList) {
    if (JSON.parse(localStorage.getItem("customers")) === null) {
        return localStorage.setItem("customers", JSON.stringify(originalCustomesList));
    }
}
setCustomersInLocalStorageOnce(clients)

let customers = JSON.parse(localStorage.getItem("customers")) ?
    JSON.parse(localStorage.getItem("customers")) : [];

render(customers);

radioInputsElements.forEach(input => {
    input.addEventListener("change", () => {
        sortBy = [...document.querySelectorAll("input[type='radio']:checked")].map(input => input.value);
        render(customers);
    })
})

function sortCombined(originalCustomers, sortCombinedOrders) {
    if (sortCombinedOrders === undefined) return originalCustomers;
    let sortedByNameOption = sortCustomersByName(originalCustomers, sortCombinedOrders[0]);
    return sortCustomersByStatus(sortedByNameOption, sortCombinedOrders[1]);
}

function showProgress(progressValue) {
    progressElement.style.width = `${progressValue}%`;
    percentElement.textContent = `Progress: ${progressValue} %`;
}

function upDateProgressValue(validInputs) {
    let progress = (100 / 9) * validInputs;
    progress = Math.round(progress);
    showProgress(progress);
}

function setCustomersInLocalStorage(originalCustomesList) {
    return localStorage.setItem("customers", JSON.stringify(originalCustomesList));
}

filterElement.addEventListener("click", (e) => {
    sortModuleElement.classList.toggle("hide-btn");
    sortModuleElement.scrollIntoView();
})

sortModuleElement.addEventListener("mouseleave", () => {
    sortModuleElement.classList.add("hide-btn");
})

updateBtn.addEventListener("click", () => {
    let isAllInputsValid = isInputsValiditySuccess(inputsElements);
    if (isAllInputsValid) {
        let customerData = getCustomerDataFromUser();
        updateTable(inputsElements, customerData, customerToUpdateIndex, "update", 1)
        submitBtn.classList.remove("hide-btn");
        btnGroupElement.classList.remove("btn-group");
        formHeaderElement.innerText = "Add Customer";
    }

})

cancelBtn.addEventListener("click", () => {
    restInputsValue(inputsElements);
    restInputsStyle(inputsElements);
    tableRowElement = document.getElementById(customerToUpdate.firstName);
    showUpHiglightedcustomer(tableRowElement);
    showNotification(notificationElement, customerToUpdate.firstName, "canceled update");
    upDateProgressValue(countValidInputs(inputsElements));
    submitBtn.classList.remove("hide-btn");
    btnGroupElement.classList.remove("btn-group");
    formHeaderElement.innerText = "Add Customer";
    submitBtn.classList.remove("hide-btn");
    btnGroupElement.classList.remove("btn-group");
    formHeaderElement.innerText = "Add Customer";
})

function getCustomerDataFromUser() {
    let firstName = firstNameElement.value.trim() !== "" ?
        valuecapitalize(firstNameElement.value) :
        firstNameElement.value;
    let lastName = lastNameElement.value.trim() !== "" ?
        valuecapitalize(lastNameElement.value) :
        lastNameElement.value;
    let id = numberElement.value;
    let description = descriptionElement.value;
    let rate = rateElement.value;
    let balance = balanceElement.value;
    let status = customerStatusElement.value;
    let deposit = depositElement.value;
    let currency = currencyElement.value;
    return {
        currency,
        rate,
        firstName,
        id,
        lastName,
        description,
        balance,
        deposit,
        status
    };
}

function valuecapitalize(word) {
    return word[0].toUpperCase() + word.slice(1).toLowerCase()
}

addCustomer.addEventListener("click", () => {
    restInputsValue(inputsElements);
    restInputsStyle(inputsElements);
    submitBtn.classList.remove("hide-btn");
    btnGroupElement.classList.remove("btn-group");
    formHeaderElement.innerText = "Add Customer";
    submitBtn.classList.remove("hide-btn");
    btnGroupElement.classList.remove("btn-group");
    formHeaderElement.innerText = "Add Customer";
    form.scrollIntoView();
    firstNameElement.focus();
    upDateProgressValue(countValidInputs(inputsElements));
})

form.addEventListener("submit", (e) => {
    e.preventDefault();
    checkInputsValidation(customers);
    let isAllInputsValid = isInputsValiditySuccess(inputsElements);
    if (isAllInputsValid) {
        let customerData = getCustomerDataFromUser();
        updateTable(inputsElements, customerData, 0, "Add");
    }
})

function showUpHiglightedcustomer(customerField) {
    if (customerField !== null) {
        customerField.scrollIntoView();
        customerField.classList.add("highlight");
        setTimeout(() => {
            customerField.classList.remove("highlight");
        }, 3000)
    }
}

firstNameElement.addEventListener("input", () => {
    if (btnGroupElement.classList.contains("btn-group")) {
        firstNameValidity(firstNameElement, originalCustomersListCopy);
    } else {
        firstNameValidity(firstNameElement, customers);
    }
    upDateProgressValue(countValidInputs(inputsElements))
})
lastNameElement.addEventListener("input", () => {
    lastNameValidity(lastNameElement);
    upDateProgressValue(countValidInputs(inputsElements))
})

numberElement.addEventListener("input", () => {
    if (btnGroupElement.classList.contains("btn-group")) {
        numberValidity(numberElement, originalCustomersListCopy);
    } else {
        numberValidity(numberElement, customers);
    }
    upDateProgressValue(countValidInputs(inputsElements))
})
rateElement.addEventListener("input", () => {
    ratetValidity(rateElement);
    upDateProgressValue(countValidInputs(inputsElements))
})

balanceElement.addEventListener("input", () => {
    balanceValidity(balanceElement);
    upDateProgressValue(countValidInputs(inputsElements))
})
customerStatusElement.addEventListener("input", () => {
    statusValidity(customerStatusElement);
    upDateProgressValue(countValidInputs(inputsElements))
})

descriptionElement.addEventListener("input", () => {
    descriptionValidity(descriptionElement);
    upDateProgressValue(countValidInputs(inputsElements))
})

depositElement.addEventListener("input", () => {
    depositValidity(depositElement);
    upDateProgressValue(countValidInputs(inputsElements))
})
currencyElement.addEventListener("input", () => {
    currencyValidity(currencyElement);
    upDateProgressValue(countValidInputs(inputsElements))
})

firstNameElement.addEventListener("blur", (e) => {
    if (!e.target.value) firstNameValidity(firstNameElement, customers);
})
lastNameElement.addEventListener("blur", (e) => {
    if (!e.target.value) lastNameValidity(lastNameElement);
})

numberElement.addEventListener("blur", (e) => {
    if (!e.target.value) numberValidity(numberElement, customers);
})
rateElement.addEventListener("blur", (e) => {
    if (!e.target.value) ratetValidity(rateElement);
})

balanceElement.addEventListener("blur", (e) => {
    if (!e.target.value) balanceValidity(balanceElement);
})
customerStatusElement.addEventListener("blur", (e) => {
    if (!e.target.value) statusValidity(customerStatusElement);
})

descriptionElement.addEventListener("blur", (e) => {
    if (!e.target.value) descriptionValidity(descriptionElement);
})

depositElement.addEventListener("blur", (e) => {
    if (!e.target.value) depositValidity(depositElement);
})
currencyElement.addEventListener("blur", (e) => {
    if (!e.target.value) currencyValidity(currencyElement);
})

function checkInputsValidation(originalCustomers) {
    firstNameValidity(firstNameElement, originalCustomers);
    lastNameValidity(lastNameElement);
    descriptionValidity(descriptionElement);
    statusValidity(customerStatusElement);
    currencyValidity(currencyElement);
    numberValidity(numberElement, originalCustomers);
    depositValidity(depositElement);
    ratetValidity(rateElement);
    balanceValidity(balanceElement);
}

function firstNameValidity(input, originalCustomers) {
    if (hasValue(input)) {
        return false;
    } else if (checkOnlyLetters(input, "[a-zA-Z]+$")) {
        return false;
    } else if (isFirstNameExist(input, originalCustomers)) {
        return false;
    } else {
        return true
    }
}

function numberValidity(input, originalCustomers) {
    if (hasValue(input)) {
        return false;
    } else if (isNumber(input)) {
        return false
    } else if (validLength(input)) {
        return false;
    } else if (isNumberExist(input, originalCustomers)) {
        return false;
    }
    return true;
}

function statusValidity(input) {
    if (hasValue(input)) {
        return false;
    }
    return true;
}

function depositValidity(input) {
    if (hasValue(input)) {
        return false;
    } else if (isNumber(input)) {
        return false;
    }
    return true;
}

function ratetValidity(input) {
    if (hasValue(input)) {
        return false;
    } else if (isNumber(input)) {
        return false;
    }
    return true;
}

function balanceValidity(input) {
    if (hasValue(input)) {
        return false;
    } else if (isNumber(input)) {
        return false;
    }
    return true;
}

function currencyValidity(input) {
    if (hasValue(input)) {
        setErrorForInput(input, `should select ${input.name}`);
        return false;
    }
    setSuccessForInput(input);
    return true;
}

function descriptionValidity(input) {
    if (hasValue(input)) {
        return false;
    } else if (validLength(input)) {
        return false;
    }
    return true
}

function lastNameValidity(input) {
    if (hasValue(input)) {
        return false;
    } else if (checkOnlyLetters(input, "[a-zA-Z]+$")) {
        return false;
    } else {
        return true
    }
}

function hasValue(input) {
    if (!input.value.trim()) {
        setErrorForInput(input, `${input.name} can't be blanck`);
        return true;
    }
    setSuccessForInput(input)
    return false;
}

function validLength(input) {
    if (input.value.length < 10) {
        if (input.name === "number") {
            setErrorForInput(input, `${input.name} should be 10 digits`);
        } else {
            setErrorForInput(input, `${input.name} should at least have 10 characters`);
        }
        return true;
    }
    setSuccessForInput(input);
    return false;
}

function isNumberExist(input, originalCustomers) {
    let isExist = originalCustomers.some(customer => customer.id == input.value);
    if (isExist) {
        setErrorForInput(input, `${input.name} already exist`);
        return true;
    }
    setSuccessForInput(input)
    return false;
}

function isFirstNameExist(input, originalCustomers) {
    let isExist = originalCustomers.some(customer => customer.firstName.toLowerCase() === input.value.toLowerCase());
    if (isExist) {
        setErrorForInput(input, `${input.name} already exist`);
        return true;
    }
    setSuccessForInput(input);
    return false;
}

function isNumber(input) {
    if (isNaN(input.value)) {
        setErrorForInput(input, `${input.name} should be numbers`);
        return true
    }
    setSuccessForInput(input);
    return false
}

function checkOnlyLetters(input, regx) {
    if (input.value.match(regx) === null) {
        setErrorForInput(input, `${input.name} should contains only letters`);
        return true;
    }
    setSuccessForInput(input)
    return false;
}

function isInputsValiditySuccess(inputsList) {
    return inputsList.every(input => {
        return input.classList.contains("success");
    })
}

function updateTable(inputsList, customerDataFromUser, index, message, number) {
    spliceDataInOriginalList(customers, index, customerDataFromUser, number)
    setCustomersInLocalStorage(customers);
    restInputsValue(inputsList);
    restInputsStyle(inputsList);
    render(customers);
    tableRowElement = document.getElementById(customerDataFromUser.firstName);
    showUpHiglightedcustomer(tableRowElement);
    showNotification(notificationElement, customerDataFromUser.firstName, message);
    upDateProgressValue(countValidInputs(inputsList));
}

function spliceDataInOriginalList(originalCustomesList, customerIndex, customerDataFromUser, number = 0) {
    originalCustomesList.splice(customerIndex, number, customerDataFromUser)
}

function restInputsValue(inputs) {
    inputs.forEach(input => input.value = "");
    customerStatusElement.selectedIndex = 0;
    currencyElement.selectedIndex = 0;
}

function restInputsStyle(inputs) {
    inputs.forEach((input) => {
        input.classList.remove("success", "error");
        input.nextElementSibling.innerHTML = "";
        //set success Icon visibility hidden
        input.nextElementSibling.nextElementSibling.classList.remove("show");
    });
}

function showNotification(notification, customerName, message) {
    notification.firstElementChild.innerHTML = `You've ${message} ${customerName} successfully&nbsp; <i class="fas fa-check-double"></i>
    <i class="fas fa-times"></i>`
    notification.classList.remove("hidden");
    notification.classList.add("animation-drop");
    setTimeout(() => {
        notification.classList.add("hidden");
        notification.classList.remove("animation-drop");
    }, 5000)
}

function setErrorForInput(input, error) {
    let errorField = input.nextElementSibling;
    let successIcon = input.parentNode.lastElementChild;
    input.classList.add("error");
    input.classList.remove("success");
    successIcon.classList.remove("show");
    errorField.innerHTML = `<i class="fas fa-exclamation"></i> ${error}`;
}

function setSuccessForInput(input) {
    let errorField = input.nextElementSibling;
    let successIcon = errorField.nextElementSibling;
    input.classList.add("success");
    errorField.innerHTML = "";
    successIcon.classList.add("show");
}

function render(customersToRender) {
    tableElement.innerHTML = "";
    rowsPerPage = selectElement.value;
    let searchedCustomers = searchCustomersByName(customersToRender);
    let sortedCombinedCustomers = sortCombined(searchedCustomers, sortBy);
    // let sortedCustomersByStatus = sortCustomersByStatus(sortedCombinedCustomers, sortStatusOrder);
    // let sortedCustomersByName = sortCustomersByName(sortedCustomersByStatus, sortNameOrder);
    customersReadyToRender = sortedCombinedCustomers;
    let currentCustomers = customersReadyToRender.slice((currentPage - 1) * rowsPerPage, rowsPerPage * (currentPage));
    currentCustomers.forEach(customer => {
        const row = createElement(customer);
        tableElement.append(row);
    });
    activeCustomerElement.innerHTML = `active customers:
     <strong>${countActiveCustomers(sortedCombinedCustomers)}</strong> / 
     <small>${sortedCombinedCustomers.length}</small>`;
    let currentCustomersStart = currentPage === 1 ? 1 : (currentPage - 1) * rowsPerPage + 1;
    let currentCustomersEnd = customersReadyToRender.length < rowsPerPage * currentPage ? (currentCustomers.length - rowsPerPage) + rowsPerPage * (currentPage) : rowsPerPage * (currentPage);
    displayedCustomerElement.innerHTML = `${currentCustomersStart}-${currentCustomersEnd} of ${sortedCombinedCustomers.length}`;
}

function createElement(customer) {
    let { firstName, lastName, description, rate, balance, deposit, status, id, currency, selected } = customer;
    let row = document.createElement("tr");
    row.setAttribute("id", firstName);

    row.innerHTML = `
    <td><input type="checkbox" onClick="changeStyleForSelectedCustomer(customers,${firstName},${id})" class="check"></td>
    <td>
        <h5 class="customer-name">${firstName} ${lastName}</h5>
        <div class="customer-id"> ${id}</div>
    </td>
    <td>
        <p class="description">${description}</p>
    </td>
    <td>
        <h3 class="rate-number">${rate}</h3>
        <h4 class="inr">${currency}</h4>
    </td>
    <td>
        <h3 class="${checkBalance(balance)}">${balance}</h3>
        <h4 class="inr">${currency}</h4>
    </td>
    <td>
        <h3 class="deposite-number">${deposit}</h3>
        <h4 class="inr">${currency}</h4>
    </td>
    <td>
        <button class="${status} ">${status}</button>
    </td>
     <td>
        <div class="flex">
            <i class="fas fa-pen" onClick="updateCustomer(customers,${id})"></i>
            <i class="far fa-trash-alt" onClick="deleteCustomer(customers,${id})"></i>
            <i class="fas fa-ellipsis-h" onClick="showOptions(event)"></i>
            <i class="far fa-times-circle hide hidden" onClick="hideOptions(event)"></i>
            <div class="options hidden">
                <small class="option">View</small>
                <small class="option">Status</small>
                <small class="option" >Print</small>
            </div>
        </div>
    </td>
    `;
    return row;
}

function showOptions(event) {
    event.target.classList.add("hidden");
    event.target.nextElementSibling.classList.remove("hidden");
    event.target.nextElementSibling.nextElementSibling.classList.remove("hidden");
}

function hideOptions(event) {
    event.target.nextElementSibling.classList.add("hidden");
    event.target.previousElementSibling.classList.remove("hidden");
    event.target.classList.add("hidden");
}

function updateCustomer(originalCustomesList, customerId) {
    customerToUpdate = originalCustomesList.find(customer => customer.id == customerId);
    let { firstName, lastName, description, rate, balance, deposit, status, id, currency } = customerToUpdate;

    formHeaderElement.innerText = "Update Customer";
    form.scrollIntoView({ behavior: "smooth", block: "end", inline: "nearest" });
    submitBtn.classList.add("hide-btn");
    btnGroupElement.classList.add("btn-group");
    customerToUpdateIndex = originalCustomesList.indexOf(customerToUpdate);
    originalCustomersListCopy = originalCustomesList.slice();
    originalCustomersListCopy.splice(customerToUpdateIndex, 1);
    firstNameElement.value = firstName;
    lastNameElement.value = lastName;
    numberElement.value = id;
    balanceElement.value = balance;
    rateElement.value = rate;
    depositElement.value = deposit;
    currencyElement.value = currency;
    customerStatusElement.value = status;
    descriptionElement.value = description;
    checkInputsValidation(originalCustomersListCopy);
    upDateProgressValue(countValidInputs(inputsElements));
}

function changeStyleForSelectedCustomer(customersList, row, customerId) {
    let customerIdex = customersList.findIndex((customer) => {
        return customer.id == customerId;
    })
    customersList[customerIdex]["selected"] = true;
    row.classList.toggle("selected");
}

function checkBalance(amount) {
    if (amount > 0) return "positive";
    if (amount < 0) return "negative";
    return;
}

searchElement.addEventListener("keyup", () => {
    currentPage = 1;
    render(customers);
})

nameElement.addEventListener("click", () => {
    if (sortStatusOrder != undefined) {
        sortStatusOrder = undefined;
        statusElement.classList.remove("sort-desc", "sort-asc");
    }

    if (sortNameOrder === "asc") {
        sortNameOrder = "desc";
        nameElement.classList.add("sort-desc");
    } else if (sortNameOrder === undefined) {
        sortNameOrder = "asc";
        nameElement.classList.add("sort-asc");
    } else {
        sortNameOrder = undefined;
        nameElement.classList.remove("sort-desc", "sort-asc");
    }
    render(customers);
})

statusElement.addEventListener("click", () => {
    if (sortNameOrder != undefined) {
        sortNameOrder = undefined;
        nameElement.classList.remove("sort-desc", "sort-asc");
    }
    if (sortStatusOrder === "asc") {
        sortStatusOrder = "desc";
        statusElement.classList.add("sort-desc")
    } else if (sortStatusOrder === undefined) {
        sortStatusOrder = "asc";
        statusElement.classList.add("sort-asc");
    } else {
        sortStatusOrder = undefined;
        statusElement.classList.remove("sort-desc", "sort-asc");
    }
    render(customers);
})

function searchCustomersByName(customersToSearchIn) {
    let searchValue = searchElement.value.toLowerCase();
    let searchedCustomers = customersToSearchIn.filter(customer => {
        return (customer.firstName.toLowerCase()).includes(searchValue) || customer.lastName.toLowerCase().includes(searchValue) || customer.description.toLowerCase().includes(searchValue);
    })
    return searchedCustomers;
}

function sortCustomersByStatus(originalCustomers, sortOrder) {
    if (sortOrder === "active") return (originalCustomers.filter((customer) => customer.status === "active"))
        .concat(originalCustomers.filter((customer) => customer.status === "inactive"));
    if (sortOrder === "inactive") return (originalCustomers.filter((customer) => customer.status === "inactive"))
        .concat(originalCustomers.filter((customer) => customer.status === "active"));
    return originalCustomers;
}

function sortCustomersByName(originalCustomers, sortOrder) {
    if (sortOrder === "asc") return originalCustomers.sort((customer1, customer2) => (customer1.firstName > customer2.firstName) ? 1 : -1);
    if (sortOrder === "desc") return originalCustomers.sort((customer1, customer2) => (customer1.firstName > customer2.firstName) ? -1 : 1);
    return originalCustomers;
}

function deleteCustomer(originalCustomers, customerId) {
    if (confirm("are you sure")) {
        customers = originalCustomers.filter(customer => {
            return customer.id != customerId;
        })
        customersReadyToRender.length < rowsPerPage * currentPage ? currentPage -= 1 : currentPage = currentPage;
        render(customers);
        setCustomersInLocalStorage(customers);
    }
}

function countActiveCustomers(customersToCountIn) {
    return customersToCountIn.filter(customer => {
        return customer.status === "active";
    }).length;
}

selectElement.addEventListener("change", () => {
    currentPage = 1;
    render(customers);
})

nextPageElement.addEventListener("click", () => {
    customersReadyToRender.length > rowsPerPage * currentPage ? currentPage += 1 : currentPage = currentPage;
    render(customers)
})

previousPageElement.addEventListener("click", () => {
    currentPage > 1 ? currentPage -= 1 : currentPage = currentPage;
    render(customers)
})